# -----------------------------------------------------------------------------
#
#   REMINDER: If you edit this file, you'll most likely also want to edit
#   circle.yml in the client repository!
#
# -----------------------------------------------------------------------------
version: 2
jobs:
  build:
    working_directory: ~/go-path/src/github.com/keybase/kbfs
    parallelism: 1

    docker:
    - image: keybaseprivate/circleci-kbfs@sha256:80acb37b198332c05f88ee9659e49de5afe63793dd152b694346eb98d3c97a22
      command: /sbin/init

    steps:
    # Clone client.
    - run: git clone https://github.com/keybase/client.git $GOPATH/src/github.com/keybase/client

    ##
    ## Build.
    ##

    - checkout

    - run:
        working_directory: ../client/shared
        environment:
          LOCAL_KBFS: 1
        command: ./react-native/gobuild.sh android

    - run: ls -la $GOPATH/src/github.com/keybase/client/shared/react-native/android/keybaselib/keybaselib.aar
